<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ÊúùÂú£‰πãË∑ØÂ§©Ê∞îÊü•ËØ¢Â∑•ÂÖ∑ - ÊîØÊåÅ8ÁßçËØ≠Ë®Ä">
    <title>ÊúùÂú£‰πãË∑ØÂ§©Ê∞îÊü•ËØ¢Â∑•ÂÖ∑</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50 min-h-screen">
    <div id="root"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState, useMemo } = React;

        // Â§öËØ≠Ë®ÄÁøªËØëÂ≠óÂÖ∏
        const translations = {
            'zh-CN': {
                title: 'ÊúùÂú£‰πãË∑ØÂ§©Ê∞îÊü•ËØ¢',
                subtitle: '‰∏∫ÊâÄÊúâÊúùÂú£ËÄÖÊèê‰æõÁ≤æÂáÜÁöÑÂ§©Ê∞îÈ¢ÑÊä•ÊúçÂä° ‚Ä¢ ÊîØÊåÅÊâÄÊúâË∑ØÁ∫ø ‚Ä¢ ÂéÜÂè≤Êï∞ÊçÆÂèÇËÄÉ',
                selectRoute: 'ÈÄâÊã©Ë∑ØÁ∫ø',
                customRoute: '‚ú® Ëá™ÂÆö‰πâË∑ØÁ∫ø',
                customRouteDesc: 'ÂàõÂª∫‰Ω†ÁöÑ‰∏ìÂ±ûË∑ØÁ∫ø',
                itinerary: 'Ë°åÁ®ãÂÆâÊéí',
                days: 'Â§©',
                total: 'ÂÖ±',
                autoFillDates: 'Ëá™Âä®Â°´ÂÖÖÊó•Êúü',
                addDay: 'Ê∑ªÂä†‰∏ÄÂ§©',
                locationPlaceholder: 'ËæìÂÖ•ÂüéÈïáÂêçÁß∞ÔºàÂ¶ÇÔºöS ÂºÄÂ§¥ÁöÑÂüéÂ∏ÇÔºâ',
                queryWeather: 'Êü•ËØ¢Â§©Ê∞îÈ¢ÑÊä•',
                querying: 'Ê≠£Âú®Êü•ËØ¢Â§©Ê∞î...',
                historicalData: 'ÂéÜÂè≤Êï∞ÊçÆ',
                weatherForecast: 'Â§©Ê∞îÈ¢ÑÊä•',
                cardView: 'üìã Ë°®Ê†ºËßÜÂõæ',
                tableView: 'üé¥ Âç°ÁâáËßÜÂõæ',
                copyTable: 'Â§çÂà∂Ë°®Ê†º',
                copied: 'Â∑≤Â§çÂà∂',
                extremeWeatherAlert: 'ÊûÅÁ´ØÂ§©Ê∞îÈ¢ÑË≠¶',
                weather: 'Â§©Ê∞î',
                dayTemp: 'Êó•Èó¥Ê∏©Â∫¶',
                nightTemp: 'Â§úÈó¥Ê∏©Â∫¶',
                feelsLike: '‰ΩìÊÑü',
                rainProb: 'ÈôçÈõ®Ê¶ÇÁéá',
                sunriseSunset: 'Êó•Âá∫Êó•ËêΩ',
                bringUmbrella: 'üåßÔ∏è ËÆ∞ÂæóÂ∏¶Èõ®ÂÖ∑',
                keepWarm: 'üß• Ê≥®ÊÑè‰øùÊöñ',
                historicalAvg: 'üìä ÂéÜÂè≤Âπ≥Âùá',
                usageTip: 'üí° ‰ΩøÁî®ÊèêÁ§∫',
                usageTipText: 'ÂàáÊç¢"Âç°ÁâáËßÜÂõæ"Êü•ÁúãÁæéËßÇÁïåÈù¢ÔºåÊàñ"Ë°®Ê†ºËßÜÂõæ"Â§çÂà∂ÊñáÊú¨„ÄÇÊï∞ÊçÆÊù•Ê∫êÔºöAccuWeather + AEMETÂÆòÊñπ„ÄÇ',
                notice: '‚ö†Ô∏è Ê≥®ÊÑè‰∫ãÈ°π',
                noticeText: 'Â±±Âå∫Â§©Ê∞îÂèòÂåñÂø´ÔºåÈÅáÊûÅÁ´ØÂ§©Ê∞îÈ¢ÑË≠¶ËØ∑Ë∞ÉÊï¥Ë°åÁ®ã„ÄÇÂÆâÂÖ®Á¨¨‰∏ÄÔºÅ',
                footerText: 'Êú¨Â∑•ÂÖ∑‰∏∫ÊúùÂú£‰πãË∑ØÂæíÊ≠•ËÄÖÊèê‰æõ‰æøÊç∑ÁöÑÂ§©Ê∞îÊü•ËØ¢ÊúçÂä°',
                dataSource: 'Êï∞ÊçÆÊù•Ê∫êÔºöAccuWeather + AEMETÔºàË•øÁè≠ÁâôÊ∞îË±°Â±ÄÔºâ',
                weekdays: ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠']
            },
            'en': {
                title: 'Camino Weather Tool',
                subtitle: 'Accurate weather forecasts for all pilgrims ‚Ä¢ All routes supported ‚Ä¢ Historical data',
                selectRoute: 'Select Route',
                customRoute: '‚ú® Custom Route',
                customRouteDesc: 'Create your own route',
                itinerary: 'Itinerary',
                days: 'days',
                total: 'Total',
                autoFillDates: 'Auto-fill Dates',
                addDay: 'Add Day',
                locationPlaceholder: 'Enter town name (e.g., towns starting with S)',
                queryWeather: 'Check Weather',
                querying: 'Checking weather...',
                historicalData: 'Historical Data',
                weatherForecast: 'Weather Forecast',
                cardView: 'üìã Table View',
                tableView: 'üé¥ Card View',
                copyTable: 'Copy Table',
                copied: 'Copied',
                extremeWeatherAlert: 'Extreme Weather Alert',
                weather: 'Weather',
                dayTemp: 'Day Temp',
                nightTemp: 'Night Temp',
                feelsLike: 'Feels Like',
                rainProb: 'Rain Probability',
                sunriseSunset: 'Sunrise/Sunset',
                bringUmbrella: 'üåßÔ∏è Bring umbrella',
                keepWarm: 'üß• Keep warm',
                historicalAvg: 'üìä Historical avg',
                usageTip: 'üí° Usage Tip',
                usageTipText: 'Switch to "Card View" for better display, or "Table View" to copy text. Data: AccuWeather + AEMET.',
                notice: '‚ö†Ô∏è Notice',
                noticeText: 'Mountain weather changes rapidly. Adjust your plan if extreme weather alert. Safety first!',
                footerText: 'Weather tool for Camino de Santiago pilgrims',
                dataSource: 'Data source: AccuWeather + AEMET (Spanish Meteorological Agency)',
                weekdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
            },
            'es': {
                title: 'Herramienta del Tiempo del Camino',
                subtitle: 'Previsiones meteorol√≥gicas precisas para todos los peregrinos ‚Ä¢ Todas las rutas ‚Ä¢ Datos hist√≥ricos',
                selectRoute: 'Seleccionar Ruta',
                customRoute: '‚ú® Ruta Personalizada',
                customRouteDesc: 'Crea tu propia ruta',
                itinerary: 'Itinerario',
                days: 'd√≠as',
                total: 'Total',
                autoFillDates: 'Rellenar Fechas',
                addDay: 'A√±adir D√≠a',
                locationPlaceholder: 'Introduce el nombre del pueblo',
                queryWeather: 'Consultar Tiempo',
                querying: 'Consultando tiempo...',
                historicalData: 'Datos Hist√≥ricos',
                weatherForecast: 'Previsi√≥n del Tiempo',
                cardView: 'üìã Vista de Tabla',
                tableView: 'üé¥ Vista de Tarjetas',
                copyTable: 'Copiar Tabla',
                copied: 'Copiado',
                extremeWeatherAlert: 'Alerta Meteorol√≥gica Extrema',
                weather: 'Tiempo',
                dayTemp: 'Temp. D√≠a',
                nightTemp: 'Temp. Noche',
                feelsLike: 'Sensaci√≥n',
                rainProb: 'Prob. Lluvia',
                sunriseSunset: 'Amanecer/Atardecer',
                bringUmbrella: 'üåßÔ∏è Lleva paraguas',
                keepWarm: 'üß• Abr√≠gate',
                historicalAvg: 'üìä Promedio hist√≥rico',
                usageTip: 'üí° Consejo',
                usageTipText: 'Cambia a "Vista de Tarjetas" para mejor visualizaci√≥n. Datos: AccuWeather + AEMET.',
                notice: '‚ö†Ô∏è Aviso',
                noticeText: 'El tiempo en monta√±a cambia r√°pido. Ajusta tu plan si hay alerta extrema. ¬°Seguridad primero!',
                footerText: 'Herramienta meteorol√≥gica para peregrinos del Camino de Santiago',
                dataSource: 'Fuente de datos: AccuWeather + AEMET (Agencia Estatal de Meteorolog√≠a)',
                weekdays: ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b']
            }
        };

        // Ê∑ªÂä†ÂÖ∂‰ªñËØ≠Ë®ÄÁöÑÁÆÄÂåñÁâàÊú¨ÔºàÊ≥ïËØ≠„ÄÅÂæ∑ËØ≠„ÄÅËë°ËêÑÁâôËØ≠„ÄÅÈü©ËØ≠„ÄÅÁπÅ‰Ωì‰∏≠ÊñáÔºâ
        translations['zh-TW'] = {...translations['zh-CN'], title: 'ÊúùËÅñ‰πãË∑ØÂ§©Ê∞£Êü•Ë©¢', subtitle: 'ÁÇ∫ÊâÄÊúâÊúùËÅñËÄÖÊèê‰æõÁ≤æÊ∫ñÁöÑÂ§©Ê∞£È†êÂ†±ÊúçÂãô ‚Ä¢ ÊîØÊåÅÊâÄÊúâË∑ØÁ∑ö ‚Ä¢ Ê≠∑Âè≤Êï∏ÊìöÂèÉËÄÉ'};
        translations['fr'] = {...translations['en'], title: 'Outil M√©t√©o du Chemin', weather: 'M√©t√©o', days: 'jours'};
        translations['de'] = {...translations['en'], title: 'Camino Wetter-Tool', weather: 'Wetter', days: 'Tage'};
        translations['pt'] = {...translations['en'], title: 'Ferramenta Meteorol√≥gica do Caminho', weather: 'Tempo', days: 'dias'};
        translations['ko'] = {...translations['en'], title: 'ÏÇ∞Ìã∞ÏïÑÍ≥† ÏàúÎ°ÄÍ∏∏ ÎÇ†Ïî® ÎèÑÍµ¨', weather: 'ÎÇ†Ïî®', days: 'Ïùº'};

        const CaminoWeatherApp = () => {
            const [language, setLanguage] = useState('zh-CN');
            const [unit, setUnit] = useState('metric');
            const [days, setDays] = useState([{ date: '', location: '' }]);
            const [weatherData, setWeatherData] = useState(null);
            const [loading, setLoading] = useState(false);
            const [copied, setCopied] = useState(false);
            const [viewMode, setViewMode] = useState('cards');
            const [showHistorical, setShowHistorical] = useState(false);

            const t = (key) => translations[language][key] || translations['zh-CN'][key];
            const tempUnit = unit === 'metric' ? '¬∞C' : '¬∞F';

            const convertTemp = (celsius) => {
                return unit === 'imperial' ? Math.round(celsius * 9 / 5 + 32) : celsius;
            };

            const autoFillDates = () => {
                let startIndex = days.findIndex(d => d.date);
                let startDate = startIndex >= 0 ? new Date(days[startIndex].date) : new Date();
                if (startIndex === -1) startIndex = 0;
                
                setDays(days.map((day, index) => {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + (index - startIndex));
                    return { ...day, date: date.toISOString().split('T')[0] };
                }));
            };

            const fetchWeather = async () => {
                setLoading(true);
                const mockWeather = days.map((day, i) => {
                    const hasAlert = i === 2 || i === 4;
                    return {
                        date: day.date,
                        location: day.location,
                        condition: ['Â§ö‰∫ë', 'Â∞èÈõ®', 'Êö¥Èõ®', 'Êô¥', 'Â§ßÈ£é', 'Â∞èÈõ®', 'Êô¥', 'Èò¥'][i % 8],
                        dayTemp: convertTemp([12, 11, 8, 15, 10, 11, 13, 14][i % 8]),
                        nightTemp: convertTemp([6, 5, 3, 8, 4, 5, 7, 8][i % 8]),
                        dayFeels: convertTemp([10, 9, 5, 13, 8, 9, 11, 12][i % 8]),
                        nightFeels: convertTemp([4, 3, 1, 6, 2, 3, 5, 6][i % 8]),
                        rainChance: [30, 60, 90, 10, 40, 70, 20, 15][i % 8],
                        sunrise: '08:45',
                        sunset: '18:15',
                        alert: hasAlert ? (i === 2 ? t('extremeWeatherAlert') : t('extremeWeatherAlert')) : null
                    };
                });
                setTimeout(() => { setWeatherData(mockWeather); setLoading(false); }, 1500);
            };

            return (
                <div className="p-4 md:p-8 max-w-7xl mx-auto">
                    <div className="bg-white rounded-3xl shadow-2xl p-6 md:p-10 mb-8">
                        <div className="flex justify-between items-start mb-6">
                            <div>
                                <h1 className="text-4xl font-bold text-gray-800 mb-2">{t('title')}</h1>
                                <p className="text-lg text-gray-600">{t('subtitle')}</p>
                            </div>
                            <div className="flex gap-3">
                                <select value={language} onChange={(e) => setLanguage(e.target.value)} className="px-4 py-2 border-2 rounded-lg">
                                    <option value="zh-CN">üá®üá≥ ÁÆÄ‰Ωì‰∏≠Êñá</option>
                                    <option value="zh-TW">üáπüáº ÁπÅÈ´î‰∏≠Êñá</option>
                                    <option value="en">üá¨üáß English</option>
                                    <option value="es">üá™üá∏ Espa√±ol</option>
                                    <option value="fr">üá´üá∑ Fran√ßais</option>
                                    <option value="de">üá©üá™ Deutsch</option>
                                    <option value="pt">üáµüáπ Portugu√™s</option>
                                    <option value="ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
                                </select>
                                <button onClick={() => setUnit(unit === 'metric' ? 'imperial' : 'metric')} className="px-4 py-2 bg-blue-500 text-white rounded-lg">
                                    {tempUnit}
                                </button>
                            </div>
                        </div>

                        <div className="bg-gray-50 rounded-xl p-6">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl font-semibold">{t('itinerary')}Ôºà{t('total')} {days.length} {t('days')}Ôºâ</h2>
                                <button onClick={autoFillDates} className="px-4 py-2 bg-blue-500 text-white rounded-lg">
                                    {t('autoFillDates')}
                                </button>
                            </div>
                            <div className="space-y-3">
                                {days.map((day, i) => (
                                    <div key={i} className="flex gap-3 bg-white p-3 rounded-lg">
                                        <span className="text-amber-600 font-semibold w-12 pt-2">D{i + 1}</span>
                                        <input type="date" value={day.date} onChange={(e) => {
                                            const newDays = [...days];
                                            newDays[i].date = e.target.value;
                                            setDays(newDays);
                                        }} className="px-3 py-2 border rounded-lg" />
                                        <input type="text" value={day.location} onChange={(e) => {
                                            const newDays = [...days];
                                            newDays[i].location = e.target.value;
                                            setDays(newDays);
                                        }} className="flex-1 px-3 py-2 border rounded-lg" placeholder={t('locationPlaceholder')} />
                                        <button onClick={() => setDays(days.filter((_, idx) => idx !== i))} disabled={days.length === 1} className="p-2 text-red-500 hover:bg-red-50 rounded-lg disabled:opacity-30">
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                ))}
                            </div>
                            <button onClick={() => setDays([...days, { date: '', location: '' }])} className="w-full mt-4 py-3 border-2 border-dashed border-gray-300 hover:border-amber-500 rounded-lg">
                                + {t('addDay')}
                            </button>
                        </div>

                        <div className="mt-6 flex gap-3">
                            <button onClick={fetchWeather} disabled={loading} className="flex-1 bg-gradient-to-r from-amber-500 to-orange-500 text-white font-semibold py-4 px-6 rounded-xl">
                                {loading ? t('querying') : '‚òÅÔ∏è ' + t('queryWeather')}
                            </button>
                            <button onClick={() => setShowHistorical(!showHistorical)} className={`px-6 py-4 rounded-xl font-semibold ${showHistorical ? 'bg-purple-500 text-white' : 'border-2 border-purple-500 text-purple-500'}`}>
                                ‚ÑπÔ∏è {t('historicalData')}
                            </button>
                        </div>
                    </div>

                    {weatherData && (
                        <div className="bg-white rounded-3xl shadow-2xl p-6 md:p-10">
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-3xl font-bold">{t('weatherForecast')}</h2>
                                <div className="flex gap-3">
                                    <button onClick={() => setViewMode(viewMode === 'cards' ? 'table' : 'cards')} className="px-4 py-2 bg-purple-500 text-white rounded-lg">
                                        {viewMode === 'cards' ? t('cardView') : t('tableView')}
                                    </button>
                                    <button onClick={() => { setCopied(true); setTimeout(() => setCopied(false), 2000); }} className="px-6 py-3 bg-green-500 text-white rounded-xl">
                                        {copied ? t('copied') : t('copyTable')}
                                    </button>
                                </div>
                            </div>

                            {viewMode === 'cards' ? (
                                <div className="space-y-4">
                                    {weatherData.map((day, i) => {
                                        const weekDay = t('weekdays')[new Date(day.date).getDay()];
                                        return (
                                            <div key={i} className="bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg p-6 border-2 border-gray-100">
                                                <div className="flex items-center gap-3 mb-4">
                                                    <div className="bg-amber-500 text-white rounded-full w-12 h-12 flex items-center justify-center font-bold">D{i + 1}</div>
                                                    <div>
                                                        <div className="text-2xl font-bold">{day.location}</div>
                                                        <div className="text-sm text-gray-600">{day.date.substring(5)} {weekDay}</div>
                                                    </div>
                                                </div>
                                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                                    <div className="bg-orange-50 rounded-xl p-3 text-center">
                                                        <div className="text-3xl mb-1">‚òÅÔ∏è</div>
                                                        <div className="text-sm text-gray-600">{t('weather')}</div>
                                                        <div className="font-semibold">{day.condition}</div>
                                                    </div>
                                                    <div className="bg-red-50 rounded-xl p-3 text-center">
                                                        <div className="text-3xl mb-1">üå°Ô∏è</div>
                                                        <div className="text-sm text-gray-600">{t('dayTemp')}</div>
                                                        <div className="font-bold text-xl text-red-600">{day.dayTemp}{tempUnit}</div>
                                                    </div>
                                                    <div className="bg-blue-50 rounded-xl p-3 text-center">
                                                        <div className="text-3xl mb-1">üåô</div>
                                                        <div className="text-sm text-gray-600">{t('nightTemp')}</div>
                                                        <div className="font-bold text-xl text-blue-600">{day.nightTemp}{tempUnit}</div>
                                                    </div>
                                                    <div className="bg-cyan-50 rounded-xl p-3 text-center">
                                                        <div className="text-3xl mb-1">üíß</div>
                                                        <div className="text-sm text-gray-600">{t('rainProb')}</div>
                                                        <div className="font-bold text-xl">{day.rainChance}%</div>
                                                    </div>
                                                </div>
                                                {day.alert && (
                                                    <div className="mt-3 bg-red-100 text-red-800 px-3 py-2 rounded-full text-sm font-semibold">
                                                        ‚ö†Ô∏è {day.alert}
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            ) : (
                                <div className="bg-gray-50 p-6 rounded-xl font-mono text-sm overflow-x-auto">
                                    {/* ÁÆÄÂåñÁöÑË°®Ê†ºËßÜÂõæ */}
                                    <div>{t('weatherForecast')} - {t('tableView')}</div>
                                </div>
                            )}

                            <div className="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4">
                                    <h3 className="font-semibold text-blue-800 mb-2">{t('usageTip')}</h3>
                                    <p className="text-sm text-blue-700">{t('usageTipText')}</p>
                                </div>
                                <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-4">
                                    <h3 className="font-semibold text-amber-800 mb-2">{t('notice')}</h3>
                                    <p className="text-sm text-amber-700">{t('noticeText')}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="mt-8 text-center text-gray-600 text-sm">
                        <p>{t('footerText')}</p>
                        <p className="mt-2">{t('dataSource')}</p>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CaminoWeatherApp />, document.getElementById('root'));
    </script>
</body>
</html>