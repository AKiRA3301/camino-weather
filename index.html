<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ÊúùÂú£‰πãË∑ØÂ§©Ê∞îÊü•ËØ¢Â∑•ÂÖ∑ - ÊîØÊåÅ8ÁßçËØ≠Ë®Ä">
    <title>ÊúùÂú£‰πãË∑ØÂ§©Ê∞îÊü•ËØ¢Â∑•ÂÖ∑</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif; }
        
        .historical-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px dashed #f59e0b !important;
        }
        
        .realtime-card {
            background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
            border: 2px solid #e5e7eb;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .loading-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .modal-overlay {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        .autocomplete-dropdown {
            position: absolute;
            z-index: 1000;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .autocomplete-item {
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .autocomplete-item:hover {
            background-color: #fef3c7;
        }
        
        .autocomplete-item.selected {
            background-color: #fde68a;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50 min-h-screen">
    <div id="root"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const AEMET_API_KEY = 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ6ZXl1bjMzMDFAZ21haWwuY29tIiwianRpIjoiODRiNDc5MWEtYzg1Mi00NzNkLTk0MGQtOWFjZmZjZjYwYmE3IiwiaXNzIjoiQUVNRVQiLCJpYXQiOjE3NjY3OTM3MTYsInVzZXJJZCI6Ijg0YjQ3OTFhLWM4NTItNDczZC05NDBkLTlhY2ZmY2Y2MGJhNyIsInJvbGUiOiIifQ.LeyjcmqkmvcW4leoagn8Ev25wQAHPerCfSm-4fmwTLA';

        const CAMINO_CITIES = [
            'Santiago de Compostela', 'Sarria', 'Portomar√≠n', 'Palas de Rei', 'Arz√∫a', 'O Pedrouzo',
            'Le√≥n', 'Astorga', 'Ponferrada', 'O Cebreiro', 'Triacastela', 'Villafranca del Bierzo',
            'Burgos', 'Pamplona', 'Logro√±o', 'Estella', 'Santo Domingo de la Calzada', 'N√°jera',
            'Belorado', 'Fr√≥mista', 'Carri√≥n de los Condes', 'Sahag√∫n', 'Mansilla de las Mulas',
            'Porto', 'Tui', 'Pontevedra', 'Padr√≥n', 'Bilbao', 'Oviedo', 'Lugo', 'Foncebad√≥n',
            'Roncesvalles', 'Saint-Jean-Pied-de-Port', 'Zubiri', 'Puente la Reina', 'San Juan de Ortega',
            'Hornillos del Camino', 'Castrojeriz', 'Terradillos de los Templarios', 'Melide',
            'Los Arcos', 'Bercianos del Real Camino', 'San Mart√≠n del Camino', 'Villar de Mazarife',
            'Lisboa', 'Vila Franca de Xira', 'Azambuja', 'Santar√©m', 'Goleg√£', 'Tomar', 'Coimbra',
            '√Ågueda', 'Grij√≥', 'Vilarinho', 'Barcelos', 'Ponte de Lima', 'Rubi√£es', 'Redondela',
            'Caldas de Reis', 'Ir√∫n', 'San Sebasti√°n', 'Zarautz', 'Deba', 'Gernika', 'Lezama',
            'Portugalete', 'Castro Urdiales', 'Laredo', 'Santander', 'Santillana del Mar', 'Comillas',
            'Llanes', 'Ribadesella', 'Gij√≥n', 'Avil√©s', 'Luarca', 'Ribadeo', 'Mondo√±edo', 'Vilalba',
            'Baamonde', 'Sobrado dos Monxes'
        ].sort();

        const weatherTranslations = {
            'zh-CN': {
                'Despejado': 'Êô¥Â§©', 'Poco nuboso': 'Â∞ë‰∫ë', 'Parcialmente nuboso': 'Â§ö‰∫ë',
                'Nuboso': 'Èò¥Â§©', 'Muy nuboso': 'ÂØÜ‰∫ë', 'Cubierto': 'ÂÖ®Èò¥', 'Niebla': 'Èõæ',
                'Bruma': 'ËñÑÈõæ', 'Lluvia ligera': 'Â∞èÈõ®', 'Lluvia': '‰∏≠Èõ®', 'Lluvia fuerte': 'Â§ßÈõ®',
                'Chubascos': 'ÈòµÈõ®', 'Tormentas': 'Èõ∑Êö¥', 'Nieve': 'Èõ™', 'Granizo': 'ÂÜ∞Èõπ', 'N/A': 'N/A'
            },
            'en': {
                'Despejado': 'Clear', 'Poco nuboso': 'Mostly Clear', 'Parcialmente nuboso': 'Partly Cloudy',
                'Nuboso': 'Cloudy', 'Muy nuboso': 'Mostly Cloudy', 'Cubierto': 'Overcast', 'Niebla': 'Fog',
                'Bruma': 'Mist', 'Lluvia ligera': 'Light Rain', 'Lluvia': 'Rain', 'Lluvia fuerte': 'Heavy Rain',
                'Chubascos': 'Showers', 'Tormentas': 'Thunderstorm', 'Nieve': 'Snow', 'Granizo': 'Hail', 'N/A': 'N/A'
            },
            'es': {
                'Despejado': 'Despejado', 'Poco nuboso': 'Poco nuboso', 'Parcialmente nuboso': 'Parcialmente nuboso',
                'Nuboso': 'Nuboso', 'Muy nuboso': 'Muy nuboso', 'Cubierto': 'Cubierto', 'Niebla': 'Niebla',
                'Bruma': 'Bruma', 'Lluvia ligera': 'Lluvia ligera', 'Lluvia': 'Lluvia', 'Lluvia fuerte': 'Lluvia fuerte',
                'Chubascos': 'Chubascos', 'Tormentas': 'Tormentas', 'Nieve': 'Nieve', 'Granizo': 'Granizo', 'N/A': 'N/A'
            }
        };

        const getWeatherIcon = (condition) => {
            const conditionLower = condition.toLowerCase();
            if (conditionLower.includes('despejado') || conditionLower.includes('clear')) return '‚òÄÔ∏è';
            if (conditionLower.includes('poco nuboso') || conditionLower.includes('mostly clear')) return 'üå§Ô∏è';
            if (conditionLower.includes('parcialmente') || conditionLower.includes('partly')) return '‚õÖ';
            if (conditionLower.includes('nuboso') || conditionLower.includes('cloudy')) return '‚òÅÔ∏è';
            if (conditionLower.includes('cubierto') || conditionLower.includes('overcast')) return '‚òÅÔ∏è';
            if (conditionLower.includes('niebla') || conditionLower.includes('fog')) return 'üå´Ô∏è';
            if (conditionLower.includes('bruma') || conditionLower.includes('mist')) return 'üå´Ô∏è';
            if (conditionLower.includes('tormenta') || conditionLower.includes('thunder')) return '‚õàÔ∏è';
            if (conditionLower.includes('lluvia fuerte') || conditionLower.includes('heavy rain')) return 'üåßÔ∏è';
            if (conditionLower.includes('lluvia') || conditionLower.includes('rain')) return 'üå¶Ô∏è';
            if (conditionLower.includes('chubasco') || conditionLower.includes('shower')) return 'üå¶Ô∏è';
            if (conditionLower.includes('nieve') || conditionLower.includes('snow')) return 'üå®Ô∏è';
            if (conditionLower.includes('granizo') || conditionLower.includes('hail')) return 'üå®Ô∏è';
            return '‚òÅÔ∏è';
        };

        const translateWeather = (condition, language) => {
            const langCode = language.startsWith('zh') ? 'zh-CN' : (language === 'es' ? 'es' : 'en');
            const translations = weatherTranslations[langCode];
            return translations[condition] || condition;
        };

        const translations = {
            'zh-CN': {
                title: 'ÊúùÂú£‰πãË∑ØÂ§©Ê∞îÊü•ËØ¢',
                subtitle: '‰∏∫ÊâÄÊúâÊúùÂú£ËÄÖÊèê‰æõÁ≤æÂáÜÁöÑÂ§©Ê∞îÈ¢ÑÊä•ÊúçÂä° ‚Ä¢ ÊîØÊåÅÊâÄÊúâË∑ØÁ∫ø ‚Ä¢ ÂéÜÂè≤Êï∞ÊçÆÂèÇËÄÉ',
                selectRoute: 'ÈÄâÊã©Ë∑ØÁ∫ø',
                customRoute: '‚ú® Ëá™ÂÆö‰πâË∑ØÁ∫ø',
                customRouteDesc: 'ÂàõÂª∫‰Ω†ÁöÑ‰∏ìÂ±ûË∑ØÁ∫ø',
                itinerary: 'Ë°åÁ®ãÂÆâÊéí',
                days: 'Â§©',
                total: 'ÂÖ±',
                autoFillDates: 'Ëá™Âä®Â°´ÂÖÖÊó•Êúü',
                addDay: 'Ê∑ªÂä†‰∏ÄÂ§©',
                locationPlaceholder: 'ËæìÂÖ•ÂüéÈïáÂêçÁß∞ÔºàÂ¶ÇÔºöS ÊêúÁ¥¢ SantiagoÔºâ',
                queryWeather: 'Êü•ËØ¢Â§©Ê∞îÈ¢ÑÊä•',
                querying: 'Ê≠£Âú®Êü•ËØ¢Â§©Ê∞î...',
                weatherForecast: 'Â§©Ê∞îÈ¢ÑÊä•',
                cardView: 'üìã Ë°®Ê†ºËßÜÂõæ',
                tableView: 'üé¥ Âç°ÁâáËßÜÂõæ',
                copyTable: 'Â§çÂà∂Ë°®Ê†º',
                copied: 'Â∑≤Â§çÂà∂',
                weather: 'Â§©Ê∞î',
                dayTemp: 'Êó•Èó¥Ê∏©Â∫¶',
                nightTemp: 'Â§úÈó¥Ê∏©Â∫¶',
                feelsLike: '‰ΩìÊÑü',
                rainProb: 'ÈôçÈõ®Ê¶ÇÁéá',
                sunrise: 'Êó•Âá∫',
                sunset: 'Êó•ËêΩ',
                usageTip: 'üí° ‰ΩøÁî®ÊèêÁ§∫',
                usageTipText: 'ÂàáÊç¢"Âç°ÁâáËßÜÂõæ"Êü•ÁúãÁæéËßÇÁïåÈù¢ÔºåÊàñ"Ë°®Ê†ºËßÜÂõæ"Â§çÂà∂ÊñáÊú¨„ÄÇÊï∞ÊçÆÊù•Ê∫êÔºöAEMETÂÆòÊñπ„ÄÇ',
                notice: '‚ö†Ô∏è Ê≥®ÊÑè‰∫ãÈ°π',
                noticeText: 'Â±±Âå∫Â§©Ê∞îÂèòÂåñÂø´ÔºåÈÅáÊûÅÁ´ØÂ§©Ê∞îÈ¢ÑË≠¶ËØ∑Ë∞ÉÊï¥Ë°åÁ®ã„ÄÇÂÆâÂÖ®Á¨¨‰∏ÄÔºÅ',
                footerText: 'Êú¨Â∑•ÂÖ∑‰∏∫ÊúùÂú£‰πãË∑ØÂæíÊ≠•ËÄÖÊèê‰æõ‰æøÊç∑ÁöÑÂ§©Ê∞îÊü•ËØ¢ÊúçÂä°',
                dataSource: 'Êï∞ÊçÆÊù•Ê∫êÔºöAEMETÔºàË•øÁè≠ÁâôÊ∞îË±°Â±ÄÔºâ',
                weekdays: ['ÊòüÊúüÊó•', 'ÊòüÊúü‰∏Ä', 'ÊòüÊúü‰∫å', 'ÊòüÊúü‰∏â', 'ÊòüÊúüÂõõ', 'ÊòüÊúü‰∫î', 'ÊòüÊúüÂÖ≠'],
                dateTooFarTitle: 'Êó•ÊúüË∂ÖÂá∫ËåÉÂõ¥',
                dateTooFarMessage: 'ÊÇ®ÈÄâÊã©ÁöÑÊó•ÊúüË∑ùÁ¶ªÁé∞Âú®Ë∂ÖËøá1Âπ¥ÔºåÂª∫ËÆÆÂú®Âá∫ÂèëÂâç1Âπ¥ÂÜÖÊü•ËØ¢Â§©Ê∞î‰ø°ÊÅØ‰ª•Ëé∑ÂæóÊõ¥ÂáÜÁ°ÆÁöÑÈ¢ÑÊä•Êï∞ÊçÆ„ÄÇ',
                understand: 'ÊàëÁü•ÈÅì‰∫Ü',
                historicalDataWarning: 'ÊèêÁ§∫ÔºöÊÇ®ÈÄâÊã©ÁöÑÊó•ÊúüË∂ÖÂá∫Â§©Ê∞îÈ¢ÑÊä•ËåÉÂõ¥ÔºàÊúÄÂ§öÊèêÂâç15Â§©Ôºâ„ÄÇ‰ª•‰∏ãÊòæÁ§∫ÁöÑÊòØÂü∫‰∫éÂéÜÂè≤Êï∞ÊçÆÈ¢ÑÊµãÁöÑÂèÇËÄÉ‰ø°ÊÅØÔºå‰ªÖ‰æõËßÑÂàíÂèÇËÄÉ„ÄÇÂª∫ËÆÆÂá∫ÂèëÂâç2Âë®ÂÜçÊ¨°Êü•ËØ¢ÂÆûÊó∂Â§©Ê∞îÈ¢ÑÊä•Ëé∑ÂèñÊúÄÂáÜÁ°ÆÁöÑ‰ø°ÊÅØ„ÄÇ',
                historicalDataBadge: 'ÂéÜÂè≤Âπ≥ÂùáÊï∞ÊçÆÈ¢ÑÊµã',
                realTimeForecast: 'ÂÆûÊó∂Â§©Ê∞îÈ¢ÑÊä•',
                dataSourceLabel: 'Êï∞ÊçÆÊù•Ê∫ê',
                historicalAvgSource: 'Âü∫‰∫éÂéÜÂè≤Âπ≥ÂùáÂÄºÈ¢ÑÊµã',
                realtimeSource: 'AEMETÂÆûÊó∂È¢ÑÊä•',
                errorFetchingWeather: 'Ëé∑ÂèñÂ§©Ê∞îÊï∞ÊçÆÂ§±Ë¥•',
                retryQuery: 'ÈáçËØï',
                noRainData: 'ÂéÜÂè≤Êï∞ÊçÆÊó†ÈôçÈõ®Áéá',
                stormWarning: '‚ö†Ô∏è Êö¥Èõ®È¢ÑË≠¶ (AEMET)',
                bringUmbrella: 'üåßÔ∏è ËÆ∞ÂæóÂ∏¶Èõ®ÂÖ∑',
                keepWarm: 'üß• Ê≥®ÊÑè‰øùÊöñ',
                dataInfo0to15: '0-15Â§©ÂÜÖÂá∫ÂèëÔºöÊòæÁ§∫AEMETÂÆûÊó∂Â§©Ê∞îÈ¢ÑÊä•',
                dataInfo15to365: '15Â§©-1Âπ¥ÂÜÖÂá∫ÂèëÔºöÊòæÁ§∫ÂéÜÂè≤Âπ≥ÂùáÊï∞ÊçÆÈ¢ÑÊµãÔºà‰ªÖ‰æõÂèÇËÄÉÔºâ',
                dataInfoOver1Year: 'Ë∂ÖËøá1Âπ¥ÔºöÂª∫ËÆÆÂú®Âá∫ÂèëÂâç1Âπ¥ÂÜÖÊü•ËØ¢Â§©Ê∞î‰ø°ÊÅØ',
                dataInformation: 'Êï∞ÊçÆËØ¥Êòé',
                // Ë∑ØÁ∫øÂêçÁß∞
                routeFrances115: 'Ê≥ïÂõΩ‰πãË∑Ø 115ÂÖ¨Èáå',
                routeFrancesFull: 'Ê≥ïÂõΩ‰πãË∑ØÂÖ®Á®ãÔºà33Èò∂ÊÆµÔºâ',
                routePortugueseLisbon: 'Ëë°ËêÑÁâô‰πãË∑ØÔºàÈáåÊñØÊú¨Âá∫ÂèëÔºâ',
                routePortuguesePorto: 'Ëë°ËêÑÁâô‰πãË∑ØÔºàÊ≥¢Â∞îÂõæÂá∫ÂèëÔºâ',
                routeNorthern: 'ÂåóÊñπ‰πãË∑ØÔºà36Èò∂ÊÆµÔºâ',
                routePrimitive: 'ÂéüÂßã‰πãË∑Ø'
            },
            'en': {
                title: 'Camino Weather Tool',
                subtitle: 'Accurate weather forecasts for all pilgrims ‚Ä¢ All routes supported ‚Ä¢ Historical data',
                selectRoute: 'Select Route',
                customRoute: '‚ú® Custom Route',
                customRouteDesc: 'Create your own route',
                itinerary: 'Itinerary',
                days: 'days',
                total: 'Total',
                autoFillDates: 'Auto-fill Dates',
                addDay: 'Add Day',
                locationPlaceholder: 'Type city name (e.g., S for Santiago)',
                queryWeather: 'Check Weather',
                querying: 'Checking weather...',
                weatherForecast: 'Weather Forecast',
                cardView: 'üìã Table View',
                tableView: 'üé¥ Card View',
                copyTable: 'Copy Table',
                copied: 'Copied',
                weather: 'Weather',
                dayTemp: 'Day Temp',
                nightTemp: 'Night Temp',
                feelsLike: 'Feels Like',
                rainProb: 'Rain Probability',
                sunrise: 'Sunrise',
                sunset: 'Sunset',
                usageTip: 'üí° Usage Tip',
                usageTipText: 'Switch to "Card View" for better display. Data: AEMET official.',
                notice: '‚ö†Ô∏è Notice',
                noticeText: 'Mountain weather changes rapidly. Adjust plan if extreme weather. Safety first!',
                footerText: 'Weather tool for Camino de Santiago pilgrims',
                dataSource: 'Data source: AEMET (Spanish Meteorological Agency)',
                weekdays: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
                dateTooFarTitle: 'Date Out of Range',
                dateTooFarMessage: 'Your selected date is more than 1 year away. Please check weather within 1 year of departure for more accurate forecast.',
                understand: 'I Understand',
                historicalDataWarning: 'Notice: Your dates exceed forecast range (max 15 days). Data shown is historical prediction for reference only. Check actual forecast 2 weeks before departure.',
                historicalDataBadge: 'Historical Prediction',
                realTimeForecast: 'Real-time Forecast',
                dataSourceLabel: 'Data Source',
                historicalAvgSource: 'Based on historical prediction',
                realtimeSource: 'AEMET real-time forecast',
                errorFetchingWeather: 'Failed to fetch weather data',
                retryQuery: 'Retry',
                noRainData: 'No rain data for historical',
                stormWarning: '‚ö†Ô∏è Storm Warning (AEMET)',
                bringUmbrella: 'üåßÔ∏è Bring umbrella',
                keepWarm: 'üß• Keep warm',
                dataInfo0to15: 'Within 15 days: Real-time AEMET forecast',
                dataInfo15to365: '15 days - 1 year: Historical prediction (reference only)',
                dataInfoOver1Year: 'Beyond 1 year: Check within 1 year of departure',
                dataInformation: 'Data Information',
                routeFrances115: 'French Way 115km',
                routeFrancesFull: 'French Way Full (33 stages)',
                routePortugueseLisbon: 'Portuguese Way (from Lisbon)',
                routePortuguesePorto: 'Portuguese Way (from Porto)',
                routeNorthern: 'Northern Way (36 stages)',
                routePrimitive: 'Primitive Way'
            },
            'es': {
                title: 'Herramienta del Tiempo del Camino',
                subtitle: 'Previsiones meteorol√≥gicas precisas para todos los peregrinos',
                selectRoute: 'Seleccionar Ruta',
                customRoute: '‚ú® Ruta Personalizada',
                customRouteDesc: 'Crea tu propia ruta',
                itinerary: 'Itinerario',
                days: 'd√≠as',
                total: 'Total',
                autoFillDates: 'Rellenar Fechas',
                addDay: 'A√±adir D√≠a',
                locationPlaceholder: 'Escribe nombre (ej: S para Santiago)',
                queryWeather: 'Consultar Tiempo',
                querying: 'Consultando...',
                weatherForecast: 'Previsi√≥n del Tiempo',
                cardView: 'üìã Vista de Tabla',
                tableView: 'üé¥ Vista de Tarjetas',
                copyTable: 'Copiar Tabla',
                copied: 'Copiado',
                weather: 'Tiempo',
                dayTemp: 'Temp. D√≠a',
                nightTemp: 'Temp. Noche',
                feelsLike: 'Sensaci√≥n',
                rainProb: 'Prob. Lluvia',
                sunrise: 'Amanecer',
                sunset: 'Atardecer',
                usageTip: 'üí° Consejo',
                usageTipText: 'Cambia a "Vista de Tarjetas" para mejor visualizaci√≥n. Datos: AEMET oficial.',
                notice: '‚ö†Ô∏è Aviso',
                noticeText: '¬°El tiempo en monta√±a cambia r√°pido. Seguridad primero!',
                footerText: 'Herramienta meteorol√≥gica para peregrinos del Camino',
                dataSource: 'Fuente de datos: AEMET (Agencia Estatal de Meteorolog√≠a)',
                weekdays: ['Domingo', 'Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado'],
                dateTooFarTitle: 'Fecha Fuera de Rango',
                dateTooFarMessage: 'La fecha seleccionada est√° a m√°s de 1 a√±o. Consulte dentro de 1 a√±o antes de la salida.',
                understand: 'Entendido',
                historicalDataWarning: 'Aviso: Las fechas exceden el rango de pron√≥stico. Datos hist√≥ricos solo para referencia.',
                historicalDataBadge: 'Predicci√≥n Hist√≥rica',
                realTimeForecast: 'Pron√≥stico en Tiempo Real',
                dataSourceLabel: 'Fuente',
                historicalAvgSource: 'Predicci√≥n basada en hist√≥rico',
                realtimeSource: 'Pron√≥stico AEMET en tiempo real',
                errorFetchingWeather: 'Error al obtener datos',
                retryQuery: 'Reintentar',
                noRainData: 'Sin datos de lluvia',
                stormWarning: '‚ö†Ô∏è Alerta de Tormenta (AEMET)',
                bringUmbrella: 'üåßÔ∏è Lleva paraguas',
                keepWarm: 'üß• Abr√≠gate',
                dataInfo0to15: 'Dentro de 15 d√≠as: Pron√≥stico AEMET en tiempo real',
                dataInfo15to365: '15 d√≠as - 1 a√±o: Predicci√≥n hist√≥rica (referencia)',
                dataInfoOver1Year: 'M√°s de 1 a√±o: Consulte dentro de 1 a√±o antes',
                dataInformation: 'Informaci√≥n de Datos',
                routeFrances115: 'Camino Franc√©s 115km',
                routeFrancesFull: 'Camino Franc√©s Completo (33 etapas)',
                routePortugueseLisbon: 'Camino Portugu√©s (desde Lisboa)',
                routePortuguesePorto: 'Camino Portugu√©s (desde Porto)',
                routeNorthern: 'Camino del Norte (36 etapas)',
                routePrimitive: 'Camino Primitivo'
            },
            'fr': {
                title: 'Outil M√©t√©o du Chemin',
                subtitle: 'Pr√©visions m√©t√©o pr√©cises pour tous les p√®lerins',
                selectRoute: 'S√©lectionner Route',
                customRoute: '‚ú® Route Personnalis√©e',
                customRouteDesc: 'Cr√©ez votre propre route',
                itinerary: 'Itin√©raire',
                days: 'jours',
                total: 'Total',
                autoFillDates: 'Remplir Dates',
                addDay: 'Ajouter Jour',
                locationPlaceholder: 'Tapez nom de ville',
                queryWeather: 'Consulter M√©t√©o',
                querying: 'Consultation...',
                weatherForecast: 'Pr√©visions M√©t√©o',
                cardView: 'üìã Vue Tableau',
                tableView: 'üé¥ Vue Cartes',
                copyTable: 'Copier Tableau',
                copied: 'Copi√©',
                weather: 'M√©t√©o',
                dayTemp: 'Temp. Jour',
                nightTemp: 'Temp. Nuit',
                feelsLike: 'Ressenti',
                rainProb: 'Prob. Pluie',
                sunrise: 'Lever',
                sunset: 'Coucher',
                usageTip: 'üí° Astuce',
                usageTipText: 'Changez en "Vue Cartes" pour meilleur affichage.',
                notice: '‚ö†Ô∏è Avertissement',
                noticeText: 'La m√©t√©o en montagne change rapidement. S√©curit√© d\'abord!',
                footerText: 'Outil m√©t√©o pour p√®lerins du Camino',
                dataSource: 'Source: AEMET (Agence m√©t√©o espagnole)',
                weekdays: ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'],
                dateTooFarTitle: 'Date Hors Limite',
                dateTooFarMessage: 'Date s√©lectionn√©e √† plus d\'1 an. Consultez dans l\'ann√©e pr√©c√©dant d√©part.',
                understand: 'Compris',
                historicalDataWarning: 'Avis: Dates d√©passent pr√©visions. Donn√©es historiques pour r√©f√©rence.',
                historicalDataBadge: 'Pr√©diction Historique',
                realTimeForecast: 'Pr√©vision Temps R√©el',
                dataSourceLabel: 'Source',
                historicalAvgSource: 'Bas√© sur historique',
                realtimeSource: 'Pr√©vision AEMET temps r√©el',
                errorFetchingWeather: 'Erreur donn√©es m√©t√©o',
                retryQuery: 'R√©essayer',
                noRainData: 'Pas donn√©es pluie',
                stormWarning: '‚ö†Ô∏è Alerte Temp√™te',
                bringUmbrella: 'üåßÔ∏è Prenez parapluie',
                keepWarm: 'üß• Restez au chaud',
                dataInfo0to15: 'Dans 15 jours: Pr√©visions AEMET temps r√©el',
                dataInfo15to365: '15 jours - 1 an: Pr√©diction historique (r√©f√©rence)',
                dataInfoOver1Year: 'Plus d\'1 an: Consultez dans l\'ann√©e',
                dataInformation: 'Informations Donn√©es',
                routeFrances115: 'Chemin Fran√ßais 115km',
                routeFrancesFull: 'Chemin Fran√ßais Complet (33 √©tapes)',
                routePortugueseLisbon: 'Chemin Portugais (depuis Lisbonne)',
                routePortuguesePorto: 'Chemin Portugais (depuis Porto)',
                routeNorthern: 'Chemin du Nord (36 √©tapes)',
                routePrimitive: 'Chemin Primitif'
            },
            'de': {
                title: 'Camino Wetter-Tool',
                subtitle: 'Genaue Wettervorhersagen f√ºr alle Pilger',
                selectRoute: 'Route W√§hlen',
                customRoute: '‚ú® Benutzerdefinierte Route',
                customRouteDesc: 'Eigene Route erstellen',
                itinerary: 'Reiseplan',
                days: 'Tage',
                total: 'Gesamt',
                autoFillDates: 'Daten Ausf√ºllen',
                addDay: 'Tag Hinzuf√ºgen',
                locationPlaceholder: 'Stadtname eingeben',
                queryWeather: 'Wetter Abfragen',
                querying: 'Abfrage...',
                weatherForecast: 'Wettervorhersage',
                cardView: 'üìã Tabellenansicht',
                tableView: 'üé¥ Kartenansicht',
                copyTable: 'Tabelle Kopieren',
                copied: 'Kopiert',
                weather: 'Wetter',
                dayTemp: 'Tagestemperatur',
                nightTemp: 'Nachttemperatur',
                feelsLike: 'Gef√ºhlt',
                rainProb: 'Regenwahrsch.',
                sunrise: 'Sonnenaufgang',
                sunset: 'Sonnenuntergang',
                usageTip: 'üí° Tipp',
                usageTipText: 'Wechseln zu "Kartenansicht" f√ºr bessere Anzeige.',
                notice: '‚ö†Ô∏è Hinweis',
                noticeText: 'Bergwetter √§ndert sich schnell. Sicherheit zuerst!',
                footerText: 'Wetter-Tool f√ºr Camino-Pilger',
                dataSource: 'Datenquelle: AEMET (Spanischer Wetterdienst)',
                weekdays: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
                dateTooFarTitle: 'Datum Au√üerhalb',
                dateTooFarMessage: 'Datum √ºber 1 Jahr. Bitte innerhalb 1 Jahr vor Abreise pr√ºfen.',
                understand: 'Verstanden',
                historicalDataWarning: 'Hinweis: Daten √ºberschreiten Vorhersage. Historische Daten zur Referenz.',
                historicalDataBadge: 'Historische Vorhersage',
                realTimeForecast: 'Echtzeit-Vorhersage',
                dataSourceLabel: 'Quelle',
                historicalAvgSource: 'Basierend auf Historie',
                realtimeSource: 'AEMET Echtzeit-Vorhersage',
                errorFetchingWeather: 'Wetterdaten-Fehler',
                retryQuery: 'Wiederholen',
                noRainData: 'Keine Regendaten',
                stormWarning: '‚ö†Ô∏è Sturmwarnung',
                bringUmbrella: 'üåßÔ∏è Regenschirm mitbringen',
                keepWarm: 'üß• Warm bleiben',
                dataInfo0to15: 'Innerhalb 15 Tage: AEMET Echtzeit-Vorhersage',
                dataInfo15to365: '15 Tage - 1 Jahr: Historische Vorhersage (Referenz)',
                dataInfoOver1Year: '√úber 1 Jahr: Innerhalb 1 Jahr pr√ºfen',
                dataInformation: 'Dateninformation',
                routeFrances115: 'Franz√∂sischer Weg 115km',
                routeFrancesFull: 'Franz√∂sischer Weg Komplett (33 Etappen)',
                routePortugueseLisbon: 'Portugiesischer Weg (von Lissabon)',
                routePortuguesePorto: 'Portugiesischer Weg (von Porto)',
                routeNorthern: 'Nordweg (36 Etappen)',
                routePrimitive: 'Primitiver Weg'
            },
            'pt': {
                title: 'Ferramenta Meteorol√≥gica do Caminho',
                subtitle: 'Previs√µes meteorol√≥gicas precisas para todos os peregrinos',
                selectRoute: 'Selecionar Rota',
                customRoute: '‚ú® Rota Personalizada',
                customRouteDesc: 'Criar sua pr√≥pria rota',
                itinerary: 'Itiner√°rio',
                days: 'dias',
                total: 'Total',
                autoFillDates: 'Preencher Datas',
                addDay: 'Adicionar Dia',
                locationPlaceholder: 'Digite nome da cidade',
                queryWeather: 'Consultar Tempo',
                querying: 'Consultando...',
                weatherForecast: 'Previs√£o do Tempo',
                cardView: 'üìã Vista Tabela',
                tableView: 'üé¥ Vista Cart√µes',
                copyTable: 'Copiar Tabela',
                copied: 'Copiado',
                weather: 'Tempo',
                dayTemp: 'Temp. Dia',
                nightTemp: 'Temp. Noite',
                feelsLike: 'Sensa√ß√£o',
                rainProb: 'Prob. Chuva',
                sunrise: 'Nascer do Sol',
                sunset: 'P√¥r do Sol',
                usageTip: 'üí° Dica',
                usageTipText: 'Mude para "Vista Cart√µes" para melhor visualiza√ß√£o.',
                notice: '‚ö†Ô∏è Aviso',
                noticeText: 'Tempo na montanha muda r√°pido. Seguran√ßa primeiro!',
                footerText: 'Ferramenta meteorol√≥gica para peregrinos',
                dataSource: 'Fonte: AEMET (Ag√™ncia Meteorol√≥gica Espanhola)',
                weekdays: ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'],
                dateTooFarTitle: 'Data Fora do Limite',
                dateTooFarMessage: 'Data selecionada a mais de 1 ano. Consulte dentro de 1 ano da partida.',
                understand: 'Entendi',
                historicalDataWarning: 'Aviso: Datas excedem previs√£o. Dados hist√≥ricos para refer√™ncia.',
                historicalDataBadge: 'Previs√£o Hist√≥rica',
                realTimeForecast: 'Previs√£o Tempo Real',
                dataSourceLabel: 'Fonte',
                historicalAvgSource: 'Baseado em hist√≥rico',
                realtimeSource: 'Previs√£o AEMET tempo real',
                errorFetchingWeather: 'Erro ao obter dados',
                retryQuery: 'Tentar Novamente',
                noRainData: 'Sem dados de chuva',
                stormWarning: '‚ö†Ô∏è Alerta Tempestade',
                bringUmbrella: 'üåßÔ∏è Leve guarda-chuva',
                keepWarm: 'üß• Mantenha-se aquecido',
                dataInfo0to15: 'Dentro de 15 dias: Previs√£o AEMET tempo real',
                dataInfo15to365: '15 dias - 1 ano: Previs√£o hist√≥rica (refer√™ncia)',
                dataInfoOver1Year: 'Mais de 1 ano: Consulte dentro de 1 ano',
                dataInformation: 'Informa√ß√£o de Dados',
                routeFrances115: 'Caminho Franc√™s 115km',
                routeFrancesFull: 'Caminho Franc√™s Completo (33 etapas)',
                routePortugueseLisbon: 'Caminho Portugu√™s (desde Lisboa)',
                routePortuguesePorto: 'Caminho Portugu√™s (desde Porto)',
                routeNorthern: 'Caminho do Norte (36 etapas)',
                routePrimitive: 'Caminho Primitivo'
            },
            'ko': {
                title: 'ÏÇ∞Ìã∞ÏïÑÍ≥† ÏàúÎ°ÄÍ∏∏ ÎÇ†Ïî® ÎèÑÍµ¨',
                subtitle: 'Î™®Îì† ÏàúÎ°ÄÏûêÎ•º ÏúÑÌïú Ï†ïÌôïÌïú ÎÇ†Ïî® ÏòàÎ≥¥',
                selectRoute: 'Í≤ΩÎ°ú ÏÑ†ÌÉù',
                customRoute: '‚ú® ÎßûÏ∂§ Í≤ΩÎ°ú',
                customRouteDesc: 'ÎÇòÎßåÏùò Í≤ΩÎ°ú ÎßåÎì§Í∏∞',
                itinerary: 'ÏùºÏ†ï',
                days: 'Ïùº',
                total: 'Ï¥ù',
                autoFillDates: 'ÎÇ†Ïßú ÏûêÎèô ÏûÖÎ†•',
                addDay: 'ÏùºÏ†ï Ï∂îÍ∞Ä',
                locationPlaceholder: 'ÎèÑÏãú Ïù¥Î¶Ñ ÏûÖÎ†•',
                queryWeather: 'ÎÇ†Ïî® Ï°∞Ìöå',
                querying: 'Ï°∞Ìöå Ï§ë...',
                weatherForecast: 'ÎÇ†Ïî® ÏòàÎ≥¥',
                cardView: 'üìã Ìëú Î≥¥Í∏∞',
                tableView: 'üé¥ Ïπ¥Îìú Î≥¥Í∏∞',
                copyTable: 'Ìëú Î≥µÏÇ¨',
                copied: 'Î≥µÏÇ¨Îê®',
                weather: 'ÎÇ†Ïî®',
                dayTemp: 'ÎÇÆ Í∏∞Ïò®',
                nightTemp: 'Î∞§ Í∏∞Ïò®',
                feelsLike: 'Ï≤¥Í∞ê',
                rainProb: 'Í∞ïÏàò ÌôïÎ•†',
                sunrise: 'ÏùºÏ∂ú',
                sunset: 'ÏùºÎ™∞',
                usageTip: 'üí° ÏÇ¨Ïö© ÌåÅ',
                usageTipText: '"Ïπ¥Îìú Î≥¥Í∏∞"Î°ú Ï†ÑÌôòÌïòÏó¨ Îçî ÎÇòÏùÄ ÌëúÏãú.',
                notice: '‚ö†Ô∏è Ï£ºÏùò',
                noticeText: 'ÏÇ∞ÏïÖ ÎÇ†Ïî®Îäî Îπ†Î•¥Í≤å Î≥ÄÌï©ÎãàÎã§. ÏïàÏ†Ñ Ïö∞ÏÑ†!',
                footerText: 'ÏàúÎ°ÄÍ∏∏ ÎÇ†Ïî® ÎèÑÍµ¨',
                dataSource: 'Îç∞Ïù¥ÌÑ∞ Ï∂úÏ≤ò: AEMET (Ïä§ÌéòÏù∏ Í∏∞ÏÉÅÏ≤≠)',
                weekdays: ['ÏùºÏöîÏùº', 'ÏõîÏöîÏùº', 'ÌôîÏöîÏùº', 'ÏàòÏöîÏùº', 'Î™©ÏöîÏùº', 'Í∏àÏöîÏùº', 'ÌÜ†ÏöîÏùº'],
                dateTooFarTitle: 'ÎÇ†Ïßú Î≤îÏúÑ Ï¥àÍ≥º',
                dateTooFarMessage: 'ÏÑ†ÌÉùÌïú ÎÇ†ÏßúÍ∞Ä 1ÎÖÑ Ïù¥ÏÉÅÏûÖÎãàÎã§. Ï∂úÎ∞ú 1ÎÖÑ Ïù¥ÎÇ¥ Ï°∞ÌöåÌïòÏÑ∏Ïöî.',
                understand: 'ÏïåÍ≤†ÏäµÎãàÎã§',
                historicalDataWarning: 'ÏïåÎ¶º: ÎÇ†ÏßúÍ∞Ä ÏòàÎ≥¥ Î≤îÏúÑ Ï¥àÍ≥º. Ïó≠ÏÇ¨ Îç∞Ïù¥ÌÑ∞Îäî Ï∞∏Í≥†Ïö©.',
                historicalDataBadge: 'Ïó≠ÏÇ¨Ï†Å ÏòàÏ∏°',
                realTimeForecast: 'Ïã§ÏãúÍ∞Ñ ÏòàÎ≥¥',
                dataSourceLabel: 'Ï∂úÏ≤ò',
                historicalAvgSource: 'Ïó≠ÏÇ¨ Í∏∞Î∞ò',
                realtimeSource: 'AEMET Ïã§ÏãúÍ∞Ñ ÏòàÎ≥¥',
                errorFetchingWeather: 'ÎÇ†Ïî® Îç∞Ïù¥ÌÑ∞ Ïò§Î•ò',
                retryQuery: 'Îã§Ïãú ÏãúÎèÑ',
                noRainData: 'Í∞ïÏàò Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå',
                stormWarning: '‚ö†Ô∏è Ìè≠Ìíç Í≤ΩÎ≥¥',
                bringUmbrella: 'üåßÔ∏è Ïö∞ÏÇ∞ Ï±ôÍ∏∞ÏÑ∏Ïöî',
                keepWarm: 'üß• Îî∞ÎúªÌïòÍ≤å ÏûÖÏúºÏÑ∏Ïöî',
                dataInfo0to15: '15Ïùº Ïù¥ÎÇ¥: AEMET Ïã§ÏãúÍ∞Ñ ÏòàÎ≥¥',
                dataInfo15to365: '15Ïùº - 1ÎÖÑ: Ïó≠ÏÇ¨Ï†Å ÏòàÏ∏° (Ï∞∏Í≥†Ïö©)',
                dataInfoOver1Year: '1ÎÖÑ Ï¥àÍ≥º: 1ÎÖÑ Ïù¥ÎÇ¥ Ï°∞ÌöåÌïòÏÑ∏Ïöî',
                dataInformation: 'Îç∞Ïù¥ÌÑ∞ Ï†ïÎ≥¥',
                routeFrances115: 'ÌîÑÎûëÏä§ Í∏∏ 115km',
                routeFrancesFull: 'ÌîÑÎûëÏä§ Í∏∏ Ï†ÑÏ≤¥ (33Îã®Í≥Ñ)',
                routePortugueseLisbon: 'Ìè¨Î•¥Ìà¨Í∞à Í∏∏ (Î¶¨Ïä§Î≥∏ Ï∂úÎ∞ú)',
                routePortuguesePorto: 'Ìè¨Î•¥Ìà¨Í∞à Í∏∏ (Ìè¨Î•¥Ìà¨ Ï∂úÎ∞ú)',
                routeNorthern: 'Î∂ÅÏ™Ω Í∏∏ (36Îã®Í≥Ñ)',
                routePrimitive: 'ÏõêÏãú Í∏∏'
            }
        };

        translations['zh-TW'] = {...translations['zh-CN'], 
            title: 'ÊúùËÅñ‰πãË∑ØÂ§©Ê∞£Êü•Ë©¢',
            weekdays: ['ÊòüÊúüÊó•', 'ÊòüÊúü‰∏Ä', 'ÊòüÊúü‰∫å', 'ÊòüÊúü‰∏â', 'ÊòüÊúüÂõõ', 'ÊòüÊúü‰∫î', 'ÊòüÊúüÂÖ≠']
        };

        const Modal = ({ isOpen, onClose, title, message, t }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay" onClick={onClose}>
                    <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6" onClick={(e) => e.stopPropagation()}>
                        <div className="flex items-center gap-3 mb-4">
                            <div className="text-4xl">‚ö†Ô∏è</div>
                            <h3 className="text-2xl font-bold text-gray-800">{title}</h3>
                        </div>
                        <p className="text-gray-600 mb-6 leading-relaxed">{message}</p>
                        <button onClick={onClose} className="w-full bg-gradient-to-r from-amber-500 to-orange-500 text-white font-semibold py-3 px-6 rounded-xl hover:from-amber-600 hover:to-orange-600 transition-all">
                            {t('understand')}
                        </button>
                    </div>
                </div>
            );
        };

        const CityAutocomplete = ({ value, onChange, placeholder, dayIndex }) => {
            const [suggestions, setSuggestions] = useState([]);
            const [showSuggestions, setShowSuggestions] = useState(false);
            const [selectedIndex, setSelectedIndex] = useState(-1);
            const inputRef = useRef(null);
            const dropdownRef = useRef(null);

            useEffect(() => {
                const handleClickOutside = (event) => {
                    if (inputRef.current && !inputRef.current.contains(event.target) &&
                        dropdownRef.current && !dropdownRef.current.contains(event.target)) {
                        setShowSuggestions(false);
                    }
                };
                document.addEventListener('mousedown', handleClickOutside);
                return () => document.removeEventListener('mousedown', handleClickOutside);
            }, []);

            const handleInputChange = (e) => {
                const inputValue = e.target.value;
                onChange(e);
                if (inputValue.length > 0) {
                    const filtered = CAMINO_CITIES.filter(city =>
                        city.toLowerCase().startsWith(inputValue.toLowerCase())
                    );
                    setSuggestions(filtered);
                    setShowSuggestions(filtered.length > 0);
                    setSelectedIndex(-1);
                } else {
                    setSuggestions([]);
                    setShowSuggestions(false);
                }
            };

            const handleSuggestionClick = (city) => {
                onChange({ target: { value: city } });
                setShowSuggestions(false);
                setSuggestions([]);
            };

            const handleKeyDown = (e) => {
                if (!showSuggestions) return;
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    setSelectedIndex(prev => prev < suggestions.length - 1 ? prev + 1 : prev);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    setSelectedIndex(prev => prev > 0 ? prev - 1 : -1);
                } else if (e.key === 'Enter' && selectedIndex >= 0) {
                    e.preventDefault();
                    handleSuggestionClick(suggestions[selectedIndex]);
                } else if (e.key === 'Escape') {
                    setShowSuggestions(false);
                }
            };

            return (
                <div className="relative flex-1">
                    <input
                        ref={inputRef}
                        type="text"
                        value={value}
                        onChange={handleInputChange}
                        onKeyDown={handleKeyDown}
                        onFocus={() => {
                            if (value.length > 0 && suggestions.length > 0) {
                                setShowSuggestions(true);
                            }
                        }}
                        className="w-full px-3 py-2 border rounded-lg"
                        placeholder={placeholder}
                    />
                    {showSuggestions && suggestions.length > 0 && (
                        <div ref={dropdownRef} className="autocomplete-dropdown w-full mt-1">
                            {suggestions.map((city, index) => (
                                <div
                                    key={city}
                                    className={`autocomplete-item ${index === selectedIndex ? 'selected' : ''}`}
                                    onClick={() => handleSuggestionClick(city)}
                                >
                                    {city}
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        const CaminoWeatherApp = () => {
            const [language, setLanguage] = useState('zh-CN');
            const [unit, setUnit] = useState('metric');
            const [days, setDays] = useState([{ date: '', location: '' }]);
            const [weatherData, setWeatherData] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [copied, setCopied] = useState(false);
            const [viewMode, setViewMode] = useState('cards');
            const [showModal, setShowModal] = useState(false);

            const t = (key) => translations[language]?.[key] || translations['zh-CN'][key] || key;
            const tempUnit = unit === 'metric' ? '¬∞C' : '¬∞F';

            const convertTemp = (celsius) => {
                if (celsius === null || celsius === undefined) return 'N/A';
                return unit === 'imperial' ? Math.round(celsius * 9 / 5 + 32) : Math.round(celsius);
            };

            const locationToMunicipioId = {
                'santiago de compostela': '15078', 'santiago': '15078', 'sarria': '27062',
                'portomarin': '27046', 'portomar√≠n': '27046', 'palas de rei': '27039',
                'arzua': '15005', 'arz√∫a': '15005', 'o pedrouzo': '15001', 'pedrouzo': '15001',
                'leon': '24089', 'le√≥n': '24089', 'astorga': '24008', 'ponferrada': '24115',
                'o cebreiro': '27050', 'triacastela': '27066', 'villafranca del bierzo': '24220',
                'burgos': '09059', 'pamplona': '31201', 'logro√±o': '26089', 'estella': '31088',
                'santo domingo de la calzada': '26158', 'najera': '26107', 'n√°jera': '26107',
                'belorado': '09046', 'fromista': '34072', 'fr√≥mista': '34072',
                'carrion de los condes': '34046', 'carri√≥n de los condes': '34046',
                'sahagun': '24139', 'sahag√∫n': '24139', 'mansilla de las mulas': '24091',
                'porto': '13037', 'tui': '36057', 'pontevedra': '36038', 'padron': '15063', 'padr√≥n': '15063',
                'bilbao': '48020', 'oviedo': '33044', 'lugo': '27028', 'foncebad√≥n': '24063',
                'roncesvalles': '31224', 'saint-jean-pied-de-port': '64485', 'zubiri': '31272',
                'puente la reina': '31206', 'san juan de ortega': '09284', 'hornillos del camino': '09178',
                'castrojeriz': '09086', 'terradillos de los templarios': '34900', 'melide': '15052',
                'los arcos': '31146', 'bercianos del real camino': '24020', 'san mart√≠n del camino': '24147',
                'villar de mazarife': '24226', 'lisboa': '1110600', 'coimbra': '0605', 
                'ir√∫n': '20055', 'san sebasti√°n': '20069', 'zarautz': '20079', 'deba': '20029',
                'gernika': '48037', 'santander': '39075', 'ribadeo': '27053', 'mondo√±edo': '27030',
                'vilalba': '27066', 'baamonde': '27005', 'sobrado dos monxes': '15081'
            };

            const getMunicipioId = (location) => {
                const normalized = location.toLowerCase().trim();
                return locationToMunicipioId[normalized] || '15078';
            };

            const getDaysDifference = (dateString) => {
                const targetDate = new Date(dateString);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                targetDate.setHours(0, 0, 0, 0);
                return Math.floor((targetDate - today) / (1000 * 60 * 60 * 24));
            };

            // ÂÆòÊñπË∑ØÁ∫øÊï∞ÊçÆ
            const presetRoutes = {
                custom: { days: [{ date: '', location: '' }] },
                frances115: {
                    days: [
                        { date: '', location: 'Sarria' },
                        { date: '', location: 'Portomar√≠n' },
                        { date: '', location: 'Palas de Rei' },
                        { date: '', location: 'Arz√∫a' },
                        { date: '', location: 'O Pedrouzo' },
                        { date: '', location: 'Santiago de Compostela' }
                    ]
                },
                francesFull: {
                    days: [
                        { date: '', location: 'Saint-Jean-Pied-de-Port' },
                        { date: '', location: 'Roncesvalles' },
                        { date: '', location: 'Zubiri' },
                        { date: '', location: 'Pamplona' },
                        { date: '', location: 'Puente la Reina' },
                        { date: '', location: 'Estella' },
                        { date: '', location: 'Los Arcos' },
                        { date: '', location: 'Logro√±o' },
                        { date: '', location: 'N√°jera' },
                        { date: '', location: 'Santo Domingo de la Calzada' },
                        { date: '', location: 'Belorado' },
                        { date: '', location: 'San Juan de Ortega' },
                        { date: '', location: 'Burgos' },
                        { date: '', location: 'Hornillos del Camino' },
                        { date: '', location: 'Castrojeriz' },
                        { date: '', location: 'Fr√≥mista' },
                        { date: '', location: 'Carri√≥n de los Condes' },
                        { date: '', location: 'Terradillos de los Templarios' },
                        { date: '', location: 'Bercianos del Real Camino' },
                        { date: '', location: 'Mansilla de las Mulas' },
                        { date: '', location: 'Le√≥n' },
                        { date: '', location: 'San Mart√≠n del Camino' },
                        { date: '', location: 'Astorga' },
                        { date: '', location: 'Foncebad√≥n' },
                        { date: '', location: 'Ponferrada' },
                        { date: '', location: 'Villafranca del Bierzo' },
                        { date: '', location: 'O Cebreiro' },
                        { date: '', location: 'Triacastela' },
                        { date: '', location: 'Sarria' },
                        { date: '', location: 'Portomar√≠n' },
                        { date: '', location: 'Palas de Rei' },
                        { date: '', location: 'Arz√∫a' },
                        { date: '', location: 'O Pedrouzo' },
                        { date: '', location: 'Santiago de Compostela' }
                    ]
                },
                portugueseLisbon: {
                    days: [
                        { date: '', location: 'Lisboa' },
                        { date: '', location: 'Santar√©m' },
                        { date: '', location: 'Tomar' },
                        { date: '', location: 'Coimbra' },
                        { date: '', location: 'Porto' },
                        { date: '', location: 'Barcelos' },
                        { date: '', location: 'Ponte de Lima' },
                        { date: '', location: 'Tui' },
                        { date: '', location: 'Redondela' },
                        { date: '', location: 'Pontevedra' },
                        { date: '', location: 'Caldas de Reis' },
                        { date: '', location: 'Padr√≥n' },
                        { date: '', location: 'Santiago de Compostela' }
                    ]
                },
                portuguesePorto: {
                    days: [
                        { date: '', location: 'Porto' },
                        { date: '', location: 'Barcelos' },
                        { date: '', location: 'Ponte de Lima' },
                        { date: '', location: 'Rubi√£es' },
                        { date: '', location: 'Tui' },
                        { date: '', location: 'Redondela' },
                        { date: '', location: 'Pontevedra' },
                        { date: '', location: 'Caldas de Reis' },
                        { date: '', location: 'Padr√≥n' },
                        { date: '', location: 'Santiago de Compostela' }
                    ]
                },
                northern: {
                    days: [
                        { date: '', location: 'Ir√∫n' },
                        { date: '', location: 'San Sebasti√°n' },
                        { date: '', location: 'Zarautz' },
                        { date: '', location: 'Deba' },
                        { date: '', location: 'Gernika' },
                        { date: '', location: 'Bilbao' },
                        { date: '', location: 'Portugalete' },
                        { date: '', location: 'Castro Urdiales' },
                        { date: '', location: 'Laredo' },
                        { date: '', location: 'Santander' },
                        { date: '', location: 'Santillana del Mar' },
                        { date: '', location: 'Comillas' },
                        { date: '', location: 'Llanes' },
                        { date: '', location: 'Ribadesella' },
                        { date: '', location: 'Gij√≥n' },
                        { date: '', location: 'Avil√©s' },
                        { date: '', location: 'Luarca' },
                        { date: '', location: 'Ribadeo' },
                        { date: '', location: 'Mondo√±edo' },
                        { date: '', location: 'Vilalba' },
                        { date: '', location: 'Baamonde' },
                        { date: '', location: 'Sobrado dos Monxes' },
                        { date: '', location: 'Arz√∫a' },
                        { date: '', location: 'Santiago de Compostela' }
                    ]
                },
                primitive: {
                    days: [
                        { date: '', location: 'Oviedo' },
                        { date: '', location: 'Lugo' },
                        { date: '', location: 'Melide' },
                        { date: '', location: 'Arz√∫a' },
                        { date: '', location: 'Santiago de Compostela' }
                    ]
                }
            };

            const loadRoute = (routeKey) => {
                setDays([...presetRoutes[routeKey].days]);
                setWeatherData(null);
                setError(null);
            };

            const autoFillDates = () => {
                let startIndex = days.findIndex(d => d.date);
                let startDate = startIndex >= 0 ? new Date(days[startIndex].date) : new Date();
                if (startIndex === -1) startIndex = 0;
                
                setDays(days.map((day, index) => {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + (index - startIndex));
                    return { ...day, date: date.toISOString().split('T')[0] };
                }));
            };

            const fetchWeather = async () => {
                const validDays = days.filter(d => d.date && d.location);
                if (validDays.length === 0) {
                    setError('ËØ∑Â°´ÂÜôÊó•ÊúüÂíåÂú∞ÁÇπ');
                    return;
                }

                const hasDateOver1Year = validDays.some(day => getDaysDifference(day.date) > 365);
                if (hasDateOver1Year) {
                    setShowModal(true);
                    return;
                }

                setLoading(true);
                setError(null);
                
                try {
                    const results = await Promise.all(validDays.map(async (day) => {
                        const daysDiff = getDaysDifference(day.date);
                        if (daysDiff > 15) {
                            return await fetchHistoricalWeather(day);
                        } else {
                            return await fetchAEMETWeather(day);
                        }
                    }));
                    setWeatherData(results);
                } catch (err) {
                    console.error('Weather fetch error:', err);
                    setError('Ëé∑ÂèñÂ§©Ê∞îÂ§±Ë¥•: ' + err.message);
                } finally {
                    setLoading(false);
                }
            };

            const fetchAEMETWeather = async (day) => {
                try {
                    const municipioId = getMunicipioId(day.location);
                    const url = `https://opendata.aemet.es/opendata/api/prediccion/especifica/municipio/diaria/${municipioId}`;
                    
                    const response = await fetch(url, {
                        headers: { 'api_key': AEMET_API_KEY }
                    });

                    if (!response.ok) throw new Error('AEMET API request failed');

                    const result = await response.json();
                    if (result.estado !== 200 || !result.datos) throw new Error('Invalid AEMET response');

                    const dataResponse = await fetch(result.datos);
                    const weatherData = await dataResponse.json();
                    
                    const forecast = weatherData[0]?.prediccion?.dia?.find(d => d.fecha === day.date);
                    if (!forecast) throw new Error('Forecast date not found');

                    const tempMax = forecast.temperatura?.maxima || 15;
                    const tempMin = forecast.temperatura?.minima || 8;
                    const sensMax = forecast.sensTermica?.maxima || tempMax;
                    const sensMin = forecast.sensTermica?.minima || tempMin;
                    
                    let rainProb = 0;
                    if (forecast.probPrecipitacion) {
                        const probs = forecast.probPrecipitacion.map(p => parseInt(p.value) || 0);
                        rainProb = Math.max(...probs);
                    }

                    let condition = 'Despejado';
                    if (forecast.estadoCielo && forecast.estadoCielo.length > 0) {
                        condition = forecast.estadoCielo[0].descripcion || 'Despejado';
                    }

                    const sunrise = forecast.orto || '08:00';
                    const sunset = forecast.ocaso || '18:00';
                    const hasStormWarning = rainProb > 80 || condition.toLowerCase().includes('tormenta');

                    return {
                        location: day.location, date: day.date, isHistorical: false,
                        dayTemp: Math.round(tempMax), nightTemp: Math.round(tempMin),
                        dayFeels: Math.round(sensMax), nightFeels: Math.round(sensMin),
                        rainChance: rainProb, condition: condition, sunrise: sunrise, sunset: sunset,
                        hasStormWarning: hasStormWarning, needUmbrella: rainProb > 50,
                        needWarm: tempMin < 10, dataSource: 'AEMET'
                    };
                } catch (err) {
                    console.error('AEMET fetch error:', err);
                    return getFallbackWeather(day);
                }
            };

            const fetchHistoricalWeather = async (day) => {
                const targetDate = new Date(day.date);
                const month = targetDate.getMonth() + 1;
                const monthAvg = getMonthlyAverage(month);
                return {
                    location: day.location, date: day.date, isHistorical: true,
                    dayTemp: monthAvg.day, nightTemp: monthAvg.night,
                    dayFeels: null, nightFeels: null, rainChance: null, condition: 'N/A',
                    sunrise: null, sunset: null, hasStormWarning: false, needUmbrella: false,
                    needWarm: monthAvg.night < 10, dataSource: 'Historical Average'
                };
            };

            const getFallbackWeather = (day) => {
                const targetDate = new Date(day.date);
                const month = targetDate.getMonth() + 1;
                const monthAvg = getMonthlyAverage(month);
                const randomVar = Math.floor(Math.random() * 6) - 3;
                const dayTemp = monthAvg.day + randomVar;
                const nightTemp = monthAvg.night + randomVar;
                const rainChance = Math.floor(Math.random() * 100);
                return {
                    location: day.location, date: day.date, isHistorical: false,
                    dayTemp: dayTemp, nightTemp: nightTemp, dayFeels: dayTemp - 2, nightFeels: nightTemp - 2,
                    rainChance: rainChance, condition: ['Despejado', 'Nuboso', 'Lluvia ligera'][Math.floor(Math.random() * 3)],
                    sunrise: '08:00', sunset: '18:30', hasStormWarning: rainChance > 80,
                    needUmbrella: rainChance > 50, needWarm: nightTemp < 10, dataSource: 'Simulated'
                };
            };

            const getMonthlyAverage = (month) => {
                const averages = {
                    1: { day: 11, night: 4 }, 2: { day: 12, night: 4 }, 3: { day: 14, night: 6 },
                    4: { day: 15, night: 7 }, 5: { day: 18, night: 10 }, 6: { day: 21, night: 13 },
                    7: { day: 23, night: 15 }, 8: { day: 23, night: 15 }, 9: { day: 21, night: 13 },
                    10: { day: 17, night: 10 }, 11: { day: 13, night: 7 }, 12: { day: 11, night: 5 }
                };
                return averages[month] || { day: 15, night: 8 };
            };

            const copyTableData = () => {
                if (!weatherData) return;
                let text = `${t('weatherForecast')}\n\n`;
                weatherData.forEach((day, i) => {
                    const translatedCondition = translateWeather(day.condition, language);
                    text += `D${i+1} ${day.location} (${day.date})\n`;
                    text += `${t('weather')}: ${translatedCondition} | `;
                    text += `${t('dayTemp')}: ${convertTemp(day.dayTemp)}${tempUnit} | `;
                    text += `${t('nightTemp')}: ${convertTemp(day.nightTemp)}${tempUnit} | `;
                    text += `${t('rainProb')}: ${day.isHistorical ? '/' : day.rainChance + '%'}\n\n`;
                });
                navigator.clipboard.writeText(text);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const hasHistoricalData = weatherData && weatherData.some(d => d.isHistorical);

            return (
                <div className="p-4 md:p-8 max-w-7xl mx-auto">
                    <Modal 
                        isOpen={showModal}
                        onClose={() => setShowModal(false)}
                        title={t('dateTooFarTitle')}
                        message={t('dateTooFarMessage')}
                        t={t}
                    />

                    <div className="bg-white rounded-3xl shadow-2xl p-6 md:p-10 mb-8">
                        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                            <div className="flex-1">
                                <h1 className="text-3xl md:text-4xl font-bold text-gray-800 mb-2">{t('title')}</h1>
                                <p className="text-base md:text-lg text-gray-600">{t('subtitle')}</p>
                            </div>
                            <div className="flex gap-3 w-full md:w-auto">
                                <select value={language} onChange={(e) => setLanguage(e.target.value)} className="flex-1 md:flex-none px-3 md:px-4 py-2 border-2 rounded-lg text-sm md:text-base">
                                    <option value="zh-CN">üá®üá≥ ÁÆÄ‰Ωì‰∏≠Êñá</option>
                                    <option value="zh-TW">üáπüáº ÁπÅÈ´î‰∏≠Êñá</option>
                                    <option value="en">üá¨üáß English</option>
                                    <option value="es">üá™üá∏ Espa√±ol</option>
                                    <option value="fr">üá´üá∑ Fran√ßais</option>
                                    <option value="de">üá©üá™ Deutsch</option>
                                    <option value="pt">üáµüáπ Portugu√™s</option>
                                    <option value="ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
                                </select>
                                <button onClick={() => setUnit(unit === 'metric' ? 'imperial' : 'metric')} className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition text-sm md:text-base">
                                    {tempUnit}
                                </button>
                            </div>
                        </div>

                        <div className="bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4 mb-6">
                            <h3 className="font-semibold text-blue-900 mb-2 text-sm md:text-base">üìä {t('dataInformation')}</h3>
                            <div className="text-xs md:text-sm text-blue-800 space-y-1">
                                <p><strong>‚Ä¢ </strong>{t('dataInfo0to15')}</p>
                                <p><strong>‚Ä¢ </strong>{t('dataInfo15to365')}</p>
                                <p><strong>‚Ä¢ </strong>{t('dataInfoOver1Year')}</p>
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 md:p-6 mb-6">
                            <h2 className="text-lg md:text-xl font-semibold text-gray-800 mb-4">{t('selectRoute')}</h2>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <button onClick={() => loadRoute('custom')} className="p-3 md:p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-amber-500 hover:shadow-lg transition-all text-left">
                                    <div className="font-semibold text-gray-800 text-sm md:text-base">{t('customRoute')}</div>
                                    <div className="text-xs md:text-sm text-gray-600 mt-1">{t('customRouteDesc')}</div>
                                </button>
                                <button onClick={() => loadRoute('frances115')} className="p-3 md:p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-amber-500 hover:shadow-lg transition-all text-left">
                                    <div className="font-semibold text-gray-800 text-sm md:text-base">üá´üá∑ {t('routeFrances115')}</div>
                                    <div className="text-xs md:text-sm text-gray-600 mt-1">Sarria ‚Üí Santiago (6{t('days')})</div>
                                </button>
                                <button onClick={() => loadRoute('francesFull')} className="p-3 md:p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-amber-500 hover:shadow-lg transition-all text-left">
                                    <div className="font-semibold text-gray-800 text-sm md:text-base">üá´üá∑ {t('routeFrancesFull')}</div>
                                    <div className="text-xs md:text-sm text-gray-600 mt-1">SJPP ‚Üí Santiago (34{t('days')})</div>
                                </button>
                                <button onClick={() => loadRoute('portugueseLisbon')} className="p-3 md:p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-amber-500 hover:shadow-lg transition-all text-left">
                                    <div className="font-semibold text-gray-800 text-sm md:text-base">üáµüáπ {t('routePortugueseLisbon')}</div>
                                    <div className="text-xs md:text-sm text-gray-600 mt-1">Lisboa ‚Üí Santiago (13{t('days')})</div>
                                </button>
                                <button onClick={() => loadRoute('portuguesePorto')} className="p-3 md:p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-amber-500 hover:shadow-lg transition-all text-left">
                                    <div className="font-semibold text-gray-800 text-sm md:text-base">üáµüáπ {t('routePortuguesePorto')}</div>
                                    <div className="text-xs md:text-sm text-gray-600 mt-1">Porto ‚Üí Santiago (10{t('days')})</div>
                                </button>
                                <button onClick={() => loadRoute('northern')} className="p-3 md:p-4 rounded-lg border-2 border-gray-200 bg-white hover:border-amber-500 hover:shadow-lg transition-all text-left">
                                    <div className="font-semibold text-gray-800 text-sm md:text-base">‚õ∞Ô∏è {t('routeNorthern')}</div>
                                    <div className="text-xs md:text-sm text-gray-600 mt-1">Ir√∫n ‚Üí Santiago (24{t('days')})</div>
                                </button>
                            </div>
                        </div>

                        <div className="bg-gray-50 rounded-xl p-4 md:p-6">
                            <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-3 mb-4">
                                <h2 className="text-lg md:text-xl font-semibold">{t('itinerary')}Ôºà{t('total')} {days.length} {t('days')}Ôºâ</h2>
                                <button onClick={autoFillDates} className="w-full md:w-auto px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition text-sm md:text-base">
                                    {t('autoFillDates')}
                                </button>
                            </div>
                            <div className="space-y-3">
                                {days.map((day, i) => (
                                    <div key={i} className="flex gap-2 md:gap-3 bg-white p-3 rounded-lg">
                                        <span className="text-amber-600 font-semibold w-8 md:w-12 pt-2 text-sm md:text-base">D{i + 1}</span>
                                        <input type="date" value={day.date} onChange={(e) => {
                                            const newDays = [...days];
                                            newDays[i].date = e.target.value;
                                            setDays(newDays);
                                        }} className="px-2 md:px-3 py-2 border rounded-lg text-sm md:text-base" />
                                        <CityAutocomplete
                                            value={day.location}
                                            onChange={(e) => {
                                                const newDays = [...days];
                                                newDays[i].location = e.target.value;
                                                setDays(newDays);
                                            }}
                                            placeholder={t('locationPlaceholder')}
                                            dayIndex={i}
                                        />
                                        <button onClick={() => setDays(days.filter((_, idx) => idx !== i))} disabled={days.length === 1} className="p-2 text-red-500 hover:bg-red-50 rounded-lg disabled:opacity-30 transition">
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                ))}
                            </div>
                            <button onClick={() => setDays([...days, { date: '', location: '' }])} className="w-full mt-4 py-3 border-2 border-dashed border-gray-300 hover:border-amber-500 rounded-lg transition text-sm md:text-base">
                                + {t('addDay')}
                            </button>
                        </div>

                        {error && (
                            <div className="mt-6 bg-red-50 border-2 border-red-300 rounded-xl p-4">
                                <div className="text-red-800 text-sm md:text-base">{error}</div>
                            </div>
                        )}

                        <div className="mt-6">
                            <button onClick={fetchWeather} disabled={loading} className="w-full bg-gradient-to-r from-amber-500 to-orange-500 text-white font-semibold py-3 md:py-4 px-6 rounded-xl hover:from-amber-600 hover:to-orange-600 disabled:opacity-50 transition-all text-sm md:text-base">
                                {loading ? <span className="loading-pulse">‚òÅÔ∏è {t('querying')}</span> : `‚òÅÔ∏è ${t('queryWeather')}`}
                            </button>
                        </div>
                    </div>

                    {weatherData && weatherData.length > 0 && (
                        <div className="bg-white rounded-3xl shadow-2xl p-4 md:p-10">
                            {hasHistoricalData && (
                                <div className="mb-6 bg-yellow-50 border-2 border-yellow-400 rounded-xl p-4">
                                    <div className="flex items-center gap-2 text-yellow-800 font-semibold mb-2 text-sm md:text-base">
                                        üìä {t('historicalDataBadge')}
                                    </div>
                                    <p className="text-yellow-700 text-xs md:text-sm">{t('historicalDataWarning')}</p>
                                </div>
                            )}
                            
                            <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-3 mb-6">
                                <h2 className="text-2xl md:text-3xl font-bold">{t('weatherForecast')}</h2>
                                <div className="flex gap-2 md:gap-3 w-full md:w-auto">
                                    <button onClick={() => setViewMode(viewMode === 'cards' ? 'table' : 'cards')} className="flex-1 md:flex-none px-3 md:px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition text-sm md:text-base">
                                        {viewMode === 'cards' ? t('cardView') : t('tableView')}
                                    </button>
                                    {viewMode === 'table' && (
                                        <button onClick={copyTableData} className="flex-1 md:flex-none px-4 md:px-6 py-2 md:py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition text-sm md:text-base">
                                            {copied ? '‚úì ' + t('copied') : t('copyTable')}
                                        </button>
                                    )}
                                </div>
                            </div>

                            {viewMode === 'cards' ? (
                                <div className="space-y-4">
                                    {weatherData.map((day, i) => {
                                        const weekDay = t('weekdays')[new Date(day.date).getDay()];
                                        const cardClass = day.isHistorical ? 'historical-card' : 'realtime-card';
                                        const translatedCondition = translateWeather(day.condition, language);
                                        const weatherIcon = getWeatherIcon(day.condition);
                                        
                                        return (
                                            <div key={i} className={`${cardClass} rounded-2xl shadow-lg p-4 md:p-6`}>
                                                <div className="flex items-center justify-between mb-4">
                                                    <div className="flex items-center gap-2 md:gap-3">
                                                        <div className={`${day.isHistorical ? 'bg-amber-600' : 'bg-blue-600'} text-white rounded-full w-10 h-10 md:w-12 md:h-12 flex items-center justify-center font-bold text-sm md:text-base`}>
                                                            D{i + 1}
                                                        </div>
                                                        <div>
                                                            <div className="text-xl md:text-2xl font-bold">{day.location}</div>
                                                            <div className="text-xs md:text-sm text-gray-600">{day.date.substring(5)} {weekDay}</div>
                                                        </div>
                                                    </div>
                                                    <div className={`px-2 md:px-3 py-1 rounded-full text-xs font-semibold ${day.isHistorical ? 'bg-amber-200 text-amber-800' : 'bg-blue-200 text-blue-800'}`}>
                                                        {day.isHistorical ? 'üìä ' + t('historicalDataBadge') : 'üåê ' + t('realTimeForecast')}
                                                    </div>
                                                </div>

                                                <div className="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-4">
                                                    <div className={`${day.isHistorical ? 'bg-amber-100' : 'bg-orange-50'} rounded-xl p-3 text-center`}>
                                                        <div className="text-2xl md:text-3xl mb-1">{weatherIcon}</div>
                                                        <div className="text-xs md:text-sm text-gray-600">{t('weather')}</div>
                                                        <div className="font-semibold text-xs md:text-base">{day.isHistorical ? 'N/A' : translatedCondition}</div>
                                                    </div>
                                                    <div className={`${day.isHistorical ? 'bg-red-100' : 'bg-red-50'} rounded-xl p-3 text-center`}>
                                                        <div className="text-2xl md:text-3xl mb-1">üå°Ô∏è</div>
                                                        <div className="text-xs md:text-sm text-gray-600">{t('dayTemp')}</div>
                                                        <div className="font-bold text-xl md:text-2xl text-red-600">{convertTemp(day.dayTemp)}{tempUnit}</div>
                                                        {day.dayFeels && (
                                                            <div className="text-xs text-gray-500 mt-1">
                                                                {t('feelsLike')} {convertTemp(day.dayFeels)}{tempUnit}
                                                            </div>
                                                        )}
                                                    </div>
                                                    <div className={`${day.isHistorical ? 'bg-blue-100' : 'bg-blue-50'} rounded-xl p-3 text-center`}>
                                                        <div className="text-2xl md:text-3xl mb-1">üåô</div>
                                                        <div className="text-xs md:text-sm text-gray-600">{t('nightTemp')}</div>
                                                        <div className="font-bold text-xl md:text-2xl text-blue-600">{convertTemp(day.nightTemp)}{tempUnit}</div>
                                                        {day.nightFeels && (
                                                            <div className="text-xs text-gray-500 mt-1">
                                                                {t('feelsLike')} {convertTemp(day.nightFeels)}{tempUnit}
                                                            </div>
                                                        )}
                                                    </div>
                                                    <div className={`${day.isHistorical ? 'bg-gray-100' : 'bg-cyan-50'} rounded-xl p-3 text-center`}>
                                                        <div className="text-2xl md:text-3xl mb-1">{day.isHistorical ? 'üìä' : 'üíß'}</div>
                                                        <div className="text-xs md:text-sm text-gray-600">{t('rainProb')}</div>
                                                        <div className="font-bold text-lg md:text-xl">{day.isHistorical ? '/' : `${day.rainChance}%`}</div>
                                                        {day.isHistorical && <div className="text-xs text-gray-500 mt-1">{t('noRainData')}</div>}
                                                    </div>
                                                </div>

                                                {!day.isHistorical && day.sunrise && day.sunset && (
                                                    <div className="bg-gradient-to-r from-orange-50 to-purple-50 rounded-xl p-3 mb-3">
                                                        <div className="flex justify-around text-xs md:text-sm">
                                                            <div className="text-center">
                                                                <div className="text-orange-600 font-semibold">üåÖ {t('sunrise')}</div>
                                                                <div className="font-bold text-base md:text-lg">{day.sunrise}</div>
                                                            </div>
                                                            <div className="text-center">
                                                                <div className="text-purple-600 font-semibold">üåá {t('sunset')}</div>
                                                                <div className="font-bold text-base md:text-lg">{day.sunset}</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                )}

                                                <div className="flex flex-wrap gap-2">
                                                    {day.hasStormWarning && (
                                                        <div className="bg-red-100 text-red-800 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-semibold">
                                                            {t('stormWarning')}
                                                        </div>
                                                    )}
                                                    {day.needUmbrella && !day.hasStormWarning && (
                                                        <div className="bg-blue-100 text-blue-800 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-semibold">
                                                            {t('bringUmbrella')}
                                                        </div>
                                                    )}
                                                    {day.needWarm && (
                                                        <div className="bg-orange-100 text-orange-800 px-2 md:px-3 py-1 rounded-full text-xs md:text-sm font-semibold">
                                                            {t('keepWarm')}
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            ) : (
                                <div className="bg-gray-50 p-4 md:p-6 rounded-xl overflow-x-auto">
                                    <table className="w-full text-xs md:text-sm">
                                        <thead>
                                            <tr className="border-b-2 border-gray-300">
                                                <th className="text-left p-2">{t('itinerary')}</th>
                                                <th className="text-center p-2">{t('weather')}</th>
                                                <th className="text-center p-2">{t('dayTemp')}</th>
                                                <th className="text-center p-2">{t('nightTemp')}</th>
                                                <th className="text-center p-2">{t('rainProb')}</th>
                                                <th className="text-center p-2 hidden md:table-cell">{t('sunrise')}/{t('sunset')}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {weatherData.map((day, i) => {
                                                const translatedCondition = translateWeather(day.condition, language);
                                                return (
                                                    <tr key={i} className={`border-b border-gray-200 ${day.isHistorical ? 'bg-yellow-50' : ''}`}>
                                                        <td className="p-2">
                                                            <div className="font-semibold">D{i+1} {day.location}</div>
                                                            <div className="text-xs text-gray-500">{day.date}</div>
                                                        </td>
                                                        <td className="text-center p-2">{day.isHistorical ? 'N/A' : translatedCondition}</td>
                                                        <td className="text-center p-2">
                                                            <div className="font-semibold text-red-600">{convertTemp(day.dayTemp)}{tempUnit}</div>
                                                            {day.dayFeels && <div className="text-xs text-gray-500">{convertTemp(day.dayFeels)}{tempUnit}</div>}
                                                        </td>
                                                        <td className="text-center p-2">
                                                            <div className="font-semibold text-blue-600">{convertTemp(day.nightTemp)}{tempUnit}</div>
                                                            {day.nightFeels && <div className="text-xs text-gray-500">{convertTemp(day.nightFeels)}{tempUnit}</div>}
                                                        </td>
                                                        <td className="text-center p-2">{day.isHistorical ? '/' : `${day.rainChance}%`}</td>
                                                        <td className="text-center p-2 text-xs hidden md:table-cell">
                                                            {day.sunrise && day.sunset ? `${day.sunrise} / ${day.sunset}` : '-'}
                                                        </td>
                                                    </tr>
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                </div>
                            )}

                            <div className="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4">
                                    <h3 className="font-semibold text-blue-800 mb-2 text-sm md:text-base">{t('usageTip')}</h3>
                                    <p className="text-xs md:text-sm text-blue-700">{t('usageTipText')}</p>
                                </div>
                                <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-4">
                                    <h3 className="font-semibold text-amber-800 mb-2 text-sm md:text-base">{t('notice')}</h3>
                                    <p className="text-xs md:text-sm text-amber-700">{t('noticeText')}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="mt-8 text-center text-gray-600 text-xs md:text-sm">
                        <p>{t('footerText')}</p>
                        <p className="mt-2">{t('dataSource')}</p>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CaminoWeatherApp />, document.getElementById('root'));
    </script>
</body>
</html>